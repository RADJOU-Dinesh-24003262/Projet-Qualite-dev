<?xml version="1.0" encoding="UTF-8"?>
<!--
    SpotBugs Exclusion Filter
    
    Ce fichier exclut les faux positifs pour le pattern de composition
    utilisé dans l'architecture du projet.
    
    Les classes Werewolf* sont des composants internes qui doivent
    conserver une référence à leur objet Werewolf parent.
    Ce n'est PAS une fuite de représentation interne, mais un
    pattern de conception intentionnel (Composition/Delegation).
-->
<FindBugsFilter>
    
    <!-- 
        Pattern de Composition dans les classes Werewolf* 
        Ces classes sont des composants internes de Werewolf et
        doivent conserver une référence à l'objet parent.
    -->
    <Match>
        <Class name="~org\.example\.model\.character\.werewolf\.Werewolf.*"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <!--
        HierarchyManager retourne maintenant des vues non-modifiables.
        Les autres classes Pack/* ne modifient que via les méthodes dédiées.
    -->
    <Match>
        <Class name="~org\.example\.model\.pack\..*Manager"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <Match>
        <Class name="org.example.model.pack.PackDisplay"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <Match>
        <Class name="org.example.model.pack.RankAssigner"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <!--
        AlphaManager doit exposer les références aux loups Alpha
        car d'autres composants doivent interagir avec eux.
    -->
    <Match>
        <Class name="org.example.model.pack.AlphaManager"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    
    <!--
        AbstractCharacter et ses sous-classes utilisent des références
        partagées vers Place car c'est le design du jeu (personnages
        appartiennent à des lieux).
    -->
    <Match>
        <Class name="org.example.model.character.AbstractCharacter"/>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
    </Match>
    
    <Match>
        <Class name="org.example.model.character.werewolf.Werewolf"/>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
    </Match>
    
    <!--
        ClanLeader gère un lieu et doit conserver une référence mutable.
    -->
    <Match>
        <Class name="org.example.model.clanLeader.ClanLeader"/>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
    </Match>
    
    <!--
        ClanLeaderMenu est une classe UI qui doit référencer son ClanLeader.
    -->
    <Match>
        <Class name="org.example.ClanLeaderMenu"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <!--
        ==== CLASSES UI (JavaFX) ====
        
        Les classes UI exposent intentionnellement leurs composants JavaFX
        pour permettre la liaison et l'interaction entre les vues.
        C'est un pattern standard dans les applications JavaFX.
    -->
    
    <!-- ControlPanel retourne des composants UI (Button, ComboBox, VBox) -->
    <Match>
        <Class name="org.example.ui.ControlPanel"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    
    <!-- GameLogger retourne sa vue ListView -->
    <Match>
        <Class name="org.example.ui.GameLogger"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    
    <!-- PlacesView retourne son conteneur -->
    <Match>
        <Class name="org.example.ui.PlacesView"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    
    <!-- GameGUI initialise ses champs dans la méthode start() de JavaFX (pas le constructeur) -->
    <Match>
        <Class name="org.example.GameGUI"/>
        <Bug pattern="UWF_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR"/>
    </Match>
    
    <!-- toUpperCase() sur du texte UI d'affichage est acceptable -->
    <Match>
        <Class name="org.example.GameGUI"/>
        <Bug pattern="DM_CONVERT_CASE"/>
    </Match>
    
    <!-- Classes anonymes UI (StringConverter) dans ControlPanel - exclues individuellement -->
    <Match>
        <Class name="org.example.ui.ControlPanel$1"/>
        <Bug pattern="SIC_INNER_SHOULD_BE_STATIC_ANON"/>
    </Match>
    <Match>
        <Class name="org.example.ui.ControlPanel$2"/>
        <Bug pattern="SIC_INNER_SHOULD_BE_STATIC_ANON"/>
    </Match>
    <Match>
        <Class name="org.example.ui.ControlPanel$3"/>
        <Bug pattern="SIC_INNER_SHOULD_BE_STATIC_ANON"/>
    </Match>
    <Match>
        <Class name="org.example.ui.ControlPanel$4"/>
        <Bug pattern="SIC_INNER_SHOULD_BE_STATIC_ANON"/>
    </Match>
    
    <!-- Méthode appelée dans le constructeur est acceptable car initActions() configure juste les handlers -->
    <Match>
        <Class name="org.example.ui.ControlPanel"/>
        <Bug pattern="MC_OVERRIDABLE_METHOD_CALL_IN_CONSTRUCTOR"/>
    </Match>
    
    <!-- 
        Switch sans default dans un menu de création de personnage 
        est acceptable car les autres cas ne créent pas de personnage
    -->
    <Match>
        <Class name="org.example.ui.ControlPanel"/>
        <Bug pattern="SF_SWITCH_NO_DEFAULT"/>
    </Match>
    
</FindBugsFilter>
